local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Camera = workspace.CurrentCamera
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

-- ========== CONFIGURAÃ‡Ã•ES ==========
local Settings = {
    ESP = {
        Enabled = true,
        NameColor = Color3.new(1, 0, 0), -- Vermelho
        DistColor = Color3.new(1, 1, 1)  -- Branco
    },
    Aimbot = {
        Enabled = true,
        Smoothness = 0.4,
        FOV = 300
    }
}

-- ========== VARIÃVEIS ==========
local ESPObjects = {}

-- ========== GUI MINIMALISTA ==========
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "SnowFPS"
screenGui.ResetOnSpawn = false
screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

-- Frame principal (bem clean)
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 180, 0, 70)
mainFrame.Position = UDim2.new(1, -190, 0, 10)
mainFrame.BackgroundColor3 = Color3.new(0.05, 0.05, 0.05)
mainFrame.BackgroundTransparency = 0.2
mainFrame.BorderSizePixel = 1
mainFrame.BorderColor3 = Color3.new(1, 0, 0) -- Vermelho
mainFrame.Active = true
mainFrame.Parent = screenGui

-- Cantos levemente arredondados
local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 4)
corner.Parent = mainFrame

-- TÃ­tulo minimalista
local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1, 0, 0, 20)
titleLabel.Position = UDim2.new(0, 5, 0, 2)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "by Snow_plw ðŸ‘‘"
titleLabel.TextColor3 = Color3.new(1, 0, 0)
titleLabel.TextXAlignment = Enum.TextXAlignment.Left
titleLabel.TextSize = 14
titleLabel.Font = Enum.Font.GothamBold
titleLabel.Parent = mainFrame

-- Linha divisÃ³ria fina
local line = Instance.new("Frame")
line.Size = UDim2.new(1, -10, 0, 1)
line.Position = UDim2.new(0, 5, 0, 22)
line.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
line.BorderSizePixel = 0
line.Parent = mainFrame

-- Frame dos botÃµes (compacto)
local buttonFrame = Instance.new("Frame")
buttonFrame.Size = UDim2.new(1, -10, 0, 20)
buttonFrame.Position = UDim2.new(0, 5, 0, 25)
buttonFrame.BackgroundTransparency = 1
buttonFrame.Parent = mainFrame

-- BotÃ£o ESP minimalista
local espButton = Instance.new("TextButton")
espButton.Size = UDim2.new(0.45, -2, 0, 18)
espButton.Position = UDim2.new(0, 0, 0, 0)
espButton.BackgroundColor3 = Settings.ESP.Enabled and Color3.new(0, 0.5, 0) or Color3.new(0.3, 0, 0)
espButton.Text = Settings.ESP.Enabled and "ESP ON" or "ESP OFF"
espButton.TextColor3 = Color3.new(1, 1, 1)
espButton.TextSize = 12
espButton.Font = Enum.Font.Gotham
espButton.BorderSizePixel = 0
espButton.Parent = buttonFrame

local espCorner = Instance.new("UICorner")
espCorner.CornerRadius = UDim.new(0, 3)
espCorner.Parent = espButton

-- BotÃ£o Aimbot minimalista
local aimbotButton = Instance.new("TextButton")
aimbotButton.Size = UDim2.new(0.45, -2, 0, 18)
aimbotButton.Position = UDim2.new(0.55, 0, 0, 0)
aimbotButton.BackgroundColor3 = Settings.Aimbot.Enabled and Color3.new(0, 0.5, 0) or Color3.new(0.3, 0, 0)
aimbotButton.Text = Settings.Aimbot.Enabled and "AIM ON" or "AIM OFF"
aimbotButton.TextColor3 = Color3.new(1, 1, 1)
aimbotButton.TextSize = 12
aimbotButton.Font = Enum.Font.Gotham
aimbotButton.BorderSizePixel = 0
aimbotButton.Parent = buttonFrame

local aimbotCorner = Instance.new("UICorner")
aimbotCorner.CornerRadius = UDim.new(0, 3)
aimbotCorner.Parent = aimbotButton

-- Status FOV (compacto)
local fovLabel = Instance.new("TextLabel")
fovLabel.Size = UDim2.new(0.5, 0, 0, 16)
fovLabel.Position = UDim2.new(0, 5, 0, 48)
fovLabel.BackgroundTransparency = 1
fovLabel.Text = "FOV: " .. Settings.Aimbot.FOV
fovLabel.TextColor3 = Color3.new(0.7, 0.7, 0.7)
fovLabel.TextXAlignment = Enum.TextXAlignment.Left
fovLabel.TextSize = 11
fovLabel.Font = Enum.Font.Gotham
fovLabel.Parent = mainFrame

-- Status alvo (compacto)
local targetLabel = Instance.new("TextLabel")
targetLabel.Size = UDim2.new(0.5, 0, 0, 16)
targetLabel.Position = UDim2.new(0.5, 0, 0, 48)
targetLabel.BackgroundTransparency = 1
targetLabel.Text = "Alvo: -"
targetLabel.TextColor3 = Color3.new(1, 0, 0)
targetLabel.TextXAlignment = Enum.TextXAlignment.Right
targetLabel.TextSize = 11
targetLabel.Font = Enum.Font.Gotham
targetLabel.Parent = mainFrame

-- ========== FUNÃ‡Ã•ES DOS BOTÃ•ES ==========

espButton.MouseButton1Click:Connect(function()
    Settings.ESP.Enabled = not Settings.ESP.Enabled
    espButton.BackgroundColor3 = Settings.ESP.Enabled and Color3.new(0, 0.5, 0) or Color3.new(0.3, 0, 0)
    espButton.Text = Settings.ESP.Enabled and "ESP ON" or "ESP OFF"
    
    for _, espData in pairs(ESPObjects) do
        if espData.Billboard then
            espData.Billboard.Enabled = Settings.ESP.Enabled
        end
    end
end)

aimbotButton.MouseButton1Click:Connect(function()
    Settings.Aimbot.Enabled = not Settings.Aimbot.Enabled
    aimbotButton.BackgroundColor3 = Settings.Aimbot.Enabled and Color3.new(0, 0.5, 0) or Color3.new(0.3, 0, 0)
    aimbotButton.Text = Settings.Aimbot.Enabled and "AIM ON" or "AIM OFF"
end)

-- ========== ESP MINIMALISTA ==========

local function createESPForPlayer(player)
    if player == LocalPlayer then return end
    
    local function onCharacterAdded(character)
        if ESPObjects[player] then
            if ESPObjects[player].Billboard then
                ESPObjects[player].Billboard:Destroy()
            end
            ESPObjects[player] = nil
        end
        
        local hrp = character:WaitForChild("HumanoidRootPart", 5)
        if not hrp then return end
        
        -- BillboardGui sem fundo
        local billboard = Instance.new("BillboardGui")
        billboard.Name = "SnowESP"
        billboard.Adornee = hrp
        billboard.Size = UDim2.new(0, 100, 0, 40)
        billboard.StudsOffset = Vector3.new(0, 2.5, 0)
        billboard.AlwaysOnTop = true
        billboard.Enabled = Settings.ESP.Enabled
        
        -- Nome do jogador (vermelho)
        local nameLabel = Instance.new("TextLabel")
        nameLabel.Size = UDim2.new(1, 0, 0.5, 0)
        nameLabel.Position = UDim2.new(0, 0, 0, 0)
        nameLabel.BackgroundTransparency = 1
        nameLabel.Text = player.Name
        nameLabel.TextColor3 = Settings.ESP.NameColor
        nameLabel.TextStrokeTransparency = 0.5 -- Borda preta para legibilidade
        nameLabel.TextStrokeColor3 = Color3.new(0, 0, 0)
        nameLabel.TextScaled = true
        nameLabel.Font = Enum.Font.GothamBold
        nameLabel.Parent = billboard
        
        -- DistÃ¢ncia (branca)
        local distLabel = Instance.new("TextLabel")
        distLabel.Size = UDim2.new(1, 0, 0.5, 0)
        distLabel.Position = UDim2.new(0, 0, 0.5, 0)
        distLabel.BackgroundTransparency = 1
        distLabel.Text = "0m"
        distLabel.TextColor3 = Settings.ESP.DistColor
        distLabel.TextStrokeTransparency = 0.5
        distLabel.TextStrokeColor3 = Color3.new(0, 0, 0)
        distLabel.TextScaled = true
        distLabel.Font = Enum.Font.Gotham
        distLabel.Parent = billboard
        
        billboard.Parent = character
        
        ESPObjects[player] = {
            Billboard = billboard,
            DistLabel = distLabel,
            HRP = hrp
        }
    end
    
    if player.Character then
        onCharacterAdded(player.Character)
    end
    
    player.CharacterAdded:Connect(onCharacterAdded)
end

local function removeESPForPlayer(player)
    if ESPObjects[player] and ESPObjects[player].Billboard then
        ESPObjects[player].Billboard:Destroy()
        ESPObjects[player] = nil
    end
end

local function updateESP()
    if not Settings.ESP.Enabled or not LocalPlayer.Character then return end
    
    local myHRP = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if not myHRP then return end
    
    for player, espData in pairs(ESPObjects) do
        if espData.HRP and espData.HRP.Parent then
            local dist = (myHRP.Position - espData.HRP.Position).Magnitude
            espData.DistLabel.Text = math.floor(dist) .. "m"
        end
    end
end

-- ========== AIMBOT ==========

local function getClosestEnemyToCursor()
    local closestEnemy = nil
    local shortestDistance = Settings.Aimbot.FOV + 1
    
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local head = player.Character:FindFirstChild("Head")
            if head then
                local humanoid = player.Character:FindFirstChild("Humanoid")
                if humanoid and humanoid.Health > 0 then
                    local screenPos, onScreen = Camera:WorldToViewportPoint(head.Position)
                    
                    if onScreen then
                        local cursorPos = Vector2.new(Mouse.X, Mouse.Y)
                        local targetPos = Vector2.new(screenPos.X, screenPos.Y)
                        local distance = (cursorPos - targetPos).Magnitude
                        
                        if distance < shortestDistance then
                            shortestDistance = distance
                            closestEnemy = player
                        end
                    end
                end
            end
        end
    end
    
    return closestEnemy, shortestDistance
end

local function aimbotFunction()
    if not Settings.Aimbot.Enabled then return end
    
    local target, distance = getClosestEnemyToCursor()
    
    if target then
        targetLabel.Text = "Alvo: " .. target.Name
    else
        targetLabel.Text = "Alvo: -"
    end
    
    if target and distance <= Settings.Aimbot.FOV then
        if UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton1) then
            local head = target.Character:FindFirstChild("Head")
            if head then
                local lookAt = CFrame.lookAt(Camera.CFrame.Position, head.Position)
                Camera.CFrame = Camera.CFrame:Lerp(lookAt, Settings.Aimbot.Smoothness)
            end
        end
    end
end

-- ========== INICIALIZAÃ‡ÃƒO ==========

for _, player in ipairs(Players:GetPlayers()) do
    createESPForPlayer(player)
end

Players.PlayerAdded:Connect(createESPForPlayer)
Players.PlayerRemoving:Connect(removeESPForPlayer)

RunService.RenderStepped:Connect(function()
    updateESP()
    aimbotFunction()
end)

-- ========== ARRASTAR ==========
local dragging = false
local dragStart, startPos

mainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
    end
end)

mainFrame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement and dragging then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end
end)

-- ========== FIM ==========
print("Snow_plw HubðŸ‘‘")
print("âœ… ESP: Nome vermelho + distÃ¢ncia")
print("ðŸŽ¯ Aimbot: Mira na cabeÃ§a")
